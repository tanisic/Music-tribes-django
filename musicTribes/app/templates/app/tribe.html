{% extends 'app/base.html' %}
{% block content %}
<div class="jumbotron">
    <div class="row">
        <div class="col-2 d-flex ">
            
                {% if user.username == tribe.created_by%}
                {% include "includes/update_tribe_button.html" with playlist=playlist %}
                {% endif %}
                {% if user.username != tribe.created_by and not is_member_of_tribe and user.is_authenticated %}
                {% include 'includes/join_button.html' with tribe=tribe %}
                {% endif %}

                {% if user.username != tribe.created_by and is_member_of_tribe and user.is_authenticated %}
                {% include 'includes/leave_tribe_button.html' with tribe=tribe %}
                <div style="margin-right: 10px;"></div>
                {% endif %}

                {% if user.is_authenticated and is_member_of_tribe %}
                {% include "includes/create_playlist_button.html " %}
                {% endif %}
  
        </div>
        <div class="col-3 d-flex justify-content-center">
            {%if tribe.logo_img%}
                <img class = "tribe-logo" src="{{tribe.logo_img.url}}"></img>
            {% else %}
                <img class = "tribe-logo" src="{{tribe.logourl}}"></img>
            {% endif%}
            <h1 style="text-align:center;">{{ tribe.name }}</h1>
        </div>
        <div class="col-3 d-flex justify-content-center">
            <h2 class="text-muted">Chieftain: {{ tribe.created_by }}</h2>
            {%if tribe.chieftain.avatar_img%}
                <img class = "avatar" src="{{tribe.chieftain.avatar_img.url}}"></img>
            {% else %}
                <img class = "avatar" src="{{tribe.chieftainn.avatarurl}}"></img>
            {% endif%}
        </div>
        <div class="col-4 ">
            {% if user.username != tribe.created_by and is_member_of_tribe and user.is_authenticated %}
            <div class = "joined-container float-right" style="display:inline;">
                <h2 style="display:inline;">Joined</h2>
                <i class="fa fa-check" aria-hidden="true"></i>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<div class="row">
    <div class="col-2">
        
        <h1>Members</h1>
        {% for tribe_member in tribe_members %}
        <div class="edit-user-header">
            {%if tribe_member.avatar_img%}
                <img class = "avatar" src="{{tribe_member.avatar_img.url}}"></img>
            {% else %}
                <img class = "avatar" src="{{tribe_member.avatarurl}}"></img>
            {% endif%}
            <h2 style="display:inline;">{{tribe_member}}</h2>
        </div>
    
        {%empty%}
        <h5 class="text-muted">This tribe has no members yet.</h5>
    
    {% endfor %}
    </div>

    <div class="col-7">
        <h1>Playlists</h1>
        
        {% for playlist in playlists %}
            
            <div class="card bg-light text-dark">
                <div class="card-body row">
                    <div class="col-10">
                        <a href="{% url 'app:playlist' tribe_id=tribe.id playlist_id=playlist.id %}"><h2>{{ playlist.name }}</h2></a>
                        <p>{{ playlist.description }}</p>
                    </div>
                    <div class="col-2">
                        {% if user == playlist.creator.user or user.is_superuser or user == tribe.chieftain %}
                        {% include "includes/update_playlist_button.html" with playlist=playlist %}
                        {% include "includes/delete_playlist_button.html" with playlist=playlist %}
                        {% endif %}
                    </div>
                </div>
            </div> 
            {%empty%}
            <h5 class="text-muted">Nothing here yet.</h5>
            {% endfor %}                      
    </div>

    <div class="col-2">
        <div class ="messages-container">
            <h1>Messages</h1>

            {% for message in messages %}
            <div class="card bg-secondary text-white">
                <div class="card-body">
                    <h5>{{message.text}}</h5>
                </div>
                <div class="card-footer">
                    
                </div>
            </div> 
            {%empty%}
            <h5 class="text-muted">Nothing here yet.</h5>
            {% endfor %}  
            {% if user.is_authenticated %}
            <h2>Post a message</h2>   
                <form action="{% url 'app:add_message' tribe.id %}" accept-charset="utf-8" method = "POST">
                        {% csrf_token %}
                        {% include 'includes/bs4_form.html' with form=form %}
                        <input type="submit" value="Post message" class="btn btn-primary">
                    
                </form>
            {%endif%}
        </div>
    </div>

<!--#row-->
</div>
{% endblock %}